# Author: maodun
# Modifydate: 2025.7.7
# Reference Wiki: [Archlinux Wiki](https://wiki.archlinux.org/)
         	  [Linux Kernel](https://kernel.org/)
         	  [GNU](https://www.gnu.org/)



# 目录
# [1 安装前准备](#1-安装前准备)
	- ## [1.1 获取安装包](#11-获取安装包)
	- ## [1.2 烧录进U盘](#12-烧录进u盘)
	- ## [1.3 进入live环境](#13-进入live环境)
	- ## [1.4 验证引导方式](#14-验证引导方式)
	- ## [1.5 连接网络](#15-连接网络)
	- ## [1.6 更新系统时间](#16-更新系统时间)
	- ## [1.7 硬盘分区](#17-硬盘分区)
	- ## [1.8 格式化分区](#18-格式化分区)
	- ## [1.9 挂载分区](#19-挂载分区)
# [2 安装系统](#2-安装系统)
	- ## [2.1 更换镜像源(选做)](#21-更换镜像源选做)
	- ## [2.2 更新软件包](#22-更新软件包)
	- ## [2.3 安装必须软件包](#23-安装必须软件包)
# [3 配置系统](#3-配置系统)
	- ## [3.1 生成文件系统表](#31-生成文件系统表)
	- ## [3.2 检查文件是否正确](#32-检查文件是否正确)	
	- ## [3.3 chroot到新安装的系统](#33-chroot到新安装的系统)
	- ## [3.4 设置本地时区并同步硬件时钟](#34-设置本地时区并同步硬件时钟)
	- ## [3.5 区域本地化设置](#35-区域本地化设置)
	- ## [3.6 创建root用户](#36-创建root用户)
	- ## [3.7 创建普通用户](#37-创建普通用户)
	- ## [3.8 安装引导程序](#38-安装引导程序)
	- ## [3.9 启用发现其他系统引导(选做)](#39-启用发现其他系统引导选做)
	- ## [3.10 生成主配置文件](#310-生成主配置文件)
# [4 重启进入系统](#4-重启进入系统)



# 1 安装前准备
## 1.1 获取安装包
从[官方下载地址](https:/archlinux.org/download/)获取iso镜像文件种子，使用[aria2]软件下载种子
通过以下步骤下载种子文件：
	1. 安装相关软件
  		`$ sudo pacman -S aria2`
	2. 使用**aria2**命令下载种子文件
  		`aria2c /path/file.torrent`


## 1.2 烧录进u盘
通过以下步骤将文件烧录进U盘:
	1. 使用**lsblk**命令查看U盘的信息:
  		`$ lsblk`
	2. 使用**dd**将iso文件写入U盘:
  		`$ sudo dd if=path/file.iso of=/dev/sdx bs=4M status=progress oflag=sync`
    			- if=...: 指定iso文件路径与名称
    			- of=...: 指定u盘的路径与名称
    			- bs=4M: 自定义写入速度
    			- status=progress: 展示进度
    			- oflag=sync：确保数据完全写入


## 1.3 进入live环境
通过以下步骤进入live环境:
	1. 进入BIOS关闭电脑的安全启动
	2. 插入U盘重新进入BIOS过程中选择相应U盘作为启动项
	3. 选择archlinux medium进入live环境

>不同电脑厂商进入BIOS方式不同,一般进入BIOS设置主要按键：DEL, ESC, F1, F2, F8, F9, F10, F12


## 1.4 验证引导方式
验证UEFI是否为64位,使用**cat命令**查看文文件:
	`$ cat /sys/firmware/efi/fw\_platform\_size` 


## 1.5 连接网络
通过以下步骤连接网络:
	1. 确保系统已经列出并启用了网络接口:  
  		`$ ip link`
	2. 确保网卡未被禁用:
  		`$ rfkill unblock all`
	3. 使用**iwd**软件连接无线网络: 
		1. 进入"iwd"环境
    			`$ iwctl`  
    		2. 查看当前网卡设备，一般为wlan0:
    			`[iwd]# device list`
    		3. 网卡扫描wifi(更新当前可用wifi) 
    			`[iwd]# station wlan0 scan`
    		4. 显示可连接的所有wifi  
    			`[iwd]# station wlan0 get-networks`
    		5. 连接wifi
    			`[iwd]# station wlan0 connect wifi名称`  
    		6. 输入相应wifi密码  
	4. 测试连接是否成功  
    		1. 退出"iwd"环境
    			`[iwd]# quit`
    		2. 网络连接测试,成功会有数据不断输出，按(Ctrl+C)可以停止该程序
    			`$ ping archlinux.org`

  
## 1.6 更新系统时间
通过以下步骤使用**timedatectl**命令更新系统时间:
	1. 设置时区
  		`$ timedatectl set-timezone Asia/Shanghai`  
	2. 查看各时间  
  		`$ timedatectl`  


## 1.7 硬盘分区
通过以下步骤对硬盘分区:  
	1. 使用**fdisk**命令查询所有硬盘情况
  		`$ fdisk -l`   
	2. 使用**cfdisk**命令对硬盘进行分区  
  		`$ cfdisk /dev/待分区硬盘名称`
	3. 分区示例
		- “Root系统盘"
    			- EFI System（boot分区）1G  
    			- Linux swap（swap分区）16G  
    			- Linux root(x86-64) (root分区）剩余空间
		- “用户数据盘”
    			- Linux home (home分区) 剩余所有空间  
	4. 使用**lsblk**命令查看当前分区情况 
  		`$ lsblk -f`  

        
## 1.8 格式化分区
通过以下步骤使用**mkfs**和**mkswap**命令格式化各个分区:  
	1. boot分区格式化  
  		`$ mkfs.fat -F 32 /dev/nvme0n1p1`  
	2. swap分区初始化  
  		`$ mkswap /dev/nvme0n1p2`  
	3. root分区格式化  
  		`$ mkfs.ext4 /dev/nvme0n1p3`  
	4. home分区格式化  
  		`$ mkfs.ext4 /dev/nvme1n1p1`  
	5. 使用**lsblk**命令查看当前分区情况 
  		`$ lsblk -f`  


## 1.9 挂载分区
通过以下步骤使用**mount**和**swapon**命令挂载各个分区,使用**mkdir**命令创造挂载点
	1. 将root分区挂载到/mnt  
  		`$ mount /dev/nvme0n1p3 /mnt`
	2. 将boot分区挂载到/mnt/boot  
  		`$ mount /dev/nvme0n1p1 /mnt/boot --mkdir`
	3. 将home分区挂载到/mnt/home  
  		`$ mount /dev/nvme1n1p1 /mnt/home --mkdir`  
	4. 启动swap区  
  		`$ swapon /dev/nvme0n1p2`  
	5. 使用**lsblk**命令查看当前挂载列表 
  		`$ lsblk -f`  



# 2 安装系统  
## 2.1 更换镜像源
通过以下步骤更换镜像源:  
	1. 停止自动选择镜像源服务  
  		`$ systemctl stop reflector`  
	2. 编辑mirrorlist文件,在server列表最上面加入镜像源地址,默认从上到下选择镜像源
  		`$ vim /etc/pacman.d/mirrorlist`

>清华镜像源:Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch 


## 2.2 更新软件包  
使用**pacman**命令更新软件库列表
	`$ pacman -Syy` 

  
## 2.3 安装必须软件包
使用**pacstrap**命令安装各部分软件包: 
	1. 安装系统相关软件包  
  		`$ pacstrap -K /mnt base base-devel linux linux-firmware linux-headers`  
	2. 后续安装UFEI引导必须软件  
  		`$ pacstrap -K /mnt grub efibootmgr`  
	3. 安装其他需要的软件  
  		`$ pacstrap -K /mnt networkmanager helix yazi`  



# 3 配置系统  
## 3.1 生成文件系统表  
	`$ genfstab -U /mnt > /mnt/etc/fstab`  


## 3.2 使用**cat**命令检查文件是否正确  
	`$ cat /mnt/etc/fstab`  


## 3.3 chroot到新安装的系统
	`$ arch-chroot /mnt`  


## 3.4 设置本地时区并同步硬件时钟
按照以下步骤设置:  
	1. 使用**ln**命令连接时区文件  
  		`$ ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime`  
	2. 使用**hwclock**同步硬件时钟  
  		`$ hwclock --systohc`  


## 3.5 区域本地化设置
按照以下步骤设置:
	1. 编辑"locale.gen"文件,取消en_US.UTF-8 UTF-8前的注释符号
  		`$ helix /etc/locale.gen`    
	2. 生成locale信息  
  		`$ locale-gen`  

>安装过程中本地化设置为英文避免出错 


## 3.6 创建root用户
按照以下步骤创建:
	1. 编辑hostname文件,添加主机名称  
  		`$ helix /etc/hostname（你想要的主机名)`  
	2. 设置root密码  
  		`$ passwd`


## 3.7 创建普通用户
按照以下步骤创建:  
	1. 使用**useradd**命令创建用户名  
  		`$ useradd -m -G wheel 用户名`  
	2. 设置相应用户密码  
  		`$ passwd 用户名`  
	3. 赋予wheel组能够执行任何命令的权限,编辑sudoers文件,去掉“%wheel ALL=（ALL:ALL）ALL”前的注释 
  		`$ sudo helix /etc/sudoers`


## 3.8 安装引导程序
使用**grub-install**命令安装引导程序
	`$ grub-install --target=x86\_64-efi --efi-directory=/boot --bootloader-id=Arch(名称可更换)`      

  
## 3.9 启用发现其他系统引导(选做)
编辑"grub"文件，去掉“GRUB\_DISABLE\_OS\_PROBER=false”前的注释  
	`$ helix /etc/default/grub`  

  
## 3.10 生成主配置文件
使用**grub-mkconfig**命令生成主配置文件  
	`$ grub-mkconfig -o /boot/grub/grub.cfg`  



# 4 重启进入系统
按照以下步骤:
	1. 使用**exit**命令退出chroot环境  
  		`$ exit`
	2. 使用**swapoff**命令临时禁用swap分区  
  		`$ swapoff -a`  
	3. 使用**umount**命令手动卸载被挂载的分区  
  		`$ umount -R /mnt（挂载点位置)` 
	4. 使用**reboot**命令重启至出现logo时拔掉U盘  
  		`$ reboot`
