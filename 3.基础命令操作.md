# Author: maodun
# Modifydate: 2025.7.7
# Reference Wiki: [Archlinux Wiki](https://wiki.archlinux.org/)
             	  [Linux Kernel](https://kernel.org/)
             	  [GNU](https://www.gnu.org/)



# 目录
# [0 帮助文档](0-帮助文档)
# [1 命令行解释器](1-命令行解释器)
	- ## [1.1 bash配置文件](#11-bash配置文件)
	- ## [1.2 shell脚本管理](#12-shell脚本管理)
	- ## [1.3 shell脚本语言](#13-shell脚本语言)
# [2 系统相关](#2-系统相关)
	- ## [2.1 系统开关](#21-系统开关)
	- ## [2.2 系统监控](#22-系统监控)
	- ## [2.3 内存管理](#23-内存管理)
	- ## [2.4 环保变量管理](#24-环境变量管理)
# [3 用户相关](#3-用户相关)
	- ## [3.1 用户信息查询](#31-用户信息查询)
	- ## [3.2 用户切换](#32-用户切换)
	- ## [3.3 用户修改](#33-用户修改)
	- ## [3.4 用户信息修改](#34-用户信息修改)
	- ## [3.5 用户组](#35-用户组)
# [4 文件相关](#4-文件相关)
	- ## [4.1 文件信息查询](#41-文件信息查询)
	- ## [4.2 文件修改](#42-文件修改)
	- ## [4.3 文件信息修改](#43-文件信息修改)
	- ## [4.4 打开文件](#44-打开文件)
# [5 软件相关](#5-软件相关)
	- ## [5.1 下载安装软件](#51-下载安装软件)
	- ## [5.2 更新软件](#52-更新软件)
	- ## [5.3 卸载软件](#53-卸载软件)
	- ## [5.4 软件进程](#54-软件进程)
# [6 硬件管理](#6-硬件管理)
	- ## [6.1 磁盘管理](#61-磁盘管理)
	- ## [6.2 内存管理](#62-内存管理)
	- ## [6.3 CPU管理](#63-cpu管理)
	- ## [6.4 其他硬件管理](#64-其他硬件管理) 
# [7 bash配置]（#7-bash配置）



# 0 帮助文档  
使用**man**命令查询命令或软件的帮助文档.
	1. 下载相关软件
  		`$ sudo pacman -S man-db man-pages`
	2. 生成关键词缓存  
  		`$ sudo mandb`  
	3. 模糊搜索内容  
  		`$ man -k 搜索内容`
	4. 精确查询内容
  		`$ man 查询内容`



# 1 命令行解释器  
## 1.1 bash配置文件
默认用户配置文件为(/.bash_profile)和(~/.bashrc")
通常将环境变量和登录初始化放在前者,交互配置放在后者,并在前者中显式调用后者.
	- "/.bash_profile":
   		1. 登录Shell(Login Shell)时加载(例如:通过ssh登录,"su - username"切换用户,或终端模拟器配置为登录模式).
    		2. 通常用于设置环境变量(如PATH环境变量)和登录时需要执行的命令(如启动服务).
	- "~/.bashrc":
    		1. 非登录Shell(Non-Login Shell)时加载(例如:直接打开终端,"su username"切换用户,或子Shell).
    		2. 通常用于定义别名(alias),函数,Shell选项等交互式功能.
    		3. 每次打开新终端窗口时都会加载.
        

## 1.2 shell脚本管理
根据shell脚本的用途与类型,将shell脚本分成不同的种类,存放在不同的目录
	1. 系统级脚本(/usr/bin/)
    		- 可供所有用户使用,通常需要root权限才能对其进行修改
    		- 通常与系统管理、初始化、配置或权限认证相关 
	2. 用户级脚本(~/.local/bin/)
    		- 仅对特定用户可见，无需root权限就能修改
	3. 应用程序脚本
    		- 某个应用程序可能会在某个目录存放和该应用相关的脚本
    		- 如,~/.cargo/bin
	4. 临时脚本: 临时或一次性脚本存放在/tmp目录,系统可能会自动清理该目录下的文件
	5. 项目脚本: 放在项目目录内部,和项目代码存放在一起

使用**cat**命令查询当前可用的命令行解释器  
	`$ cat /etc/shells`   
    
使用**touch**命令创建脚本  
	`$ touch scriptname.sh`  

可以在脚本开头添加Shebang指令("#!"+指令)用来指定脚本的解释器,即告诉系统应该用哪个程序来执行这个脚本
  	- "#!/bin/bash": 使用标准Bash解释器
  	- "#!/usr/bin/env bash": 从$PATH环境变量查找bash(更加灵活与兼容,跨平台使用)
  	- "#!/bin/sh": 使用系统默认Shell
  	- "#!/usr/bin/python3": 指定用Python3执行脚本
  
执行脚本  
	1. 直接执行脚本
    		- 需要可执行权限
    			`$ chmod +x script.sh`
    		- 脚本必须通过shebang指令指定解释器
    		- 执行脚本命令
    			`$ scriptname.sh`        
	2. 调用命令解释器执行脚本
    		- 不需要可执行权限
    		- 忽略脚本shebang指令指定的解释器
    		- 可使用不同的命令解释器执行脚本
      			- `$ bash scriptname.sh`: 使用**bash**软件
      			- `$ sh scriptname.sh`: 使用系统默认**sh**软件
	3. 使用**source**命令在当前shell环境执行脚本内的命令
    		- 不需要可执行权限
    		- 在当前Shell进程中执行
    		- 执行脚本命令
      			- `$ source scriptname.sh`
      			- `$ . scriptname.sh`

> 当处于脚本所在目录时,不需要加完整路径 
> 若要使脚本能够全局调用,需要保证脚本所在的目录已被包含在PATH环境变量中.  


## 1.3 shell脚本语言



# 2 系统相关
## 2.1 系统开关
使用**poweroff**命令管理系统的开关
	- `$ shutdown`: 在一分钟后关闭系统
	- `$ reboot`: 重新启动系统


## 2.2 系统监控
使用**top**命令实时监控系统,包括实时系统概览和软件进程列表
	- 实时系统概览
    		- 显示系统的运行时间、登录用户数、平均负载(1/5/15分钟)
    		- CPU使用率：用户态、内核态、空闲等状态占比
    		- 内存使用：物理内存(RAM)和交换空间(Swap)的使用情况
	- 进程列表
    		- PID：进程ID
    		- USER：进程所有者
    		- %CPU: CPU占用百分比
    		- %MEM：内存占用百分比
    		- VIRT、RES、SHR：虚拟内存、物理内存、共享内存大小
    		- TIME+：进程运行时间
    		- COMMAND：启动命令


## 2.3 内存管理
使用**sync**命令将数据由内存同步到硬盘  
	`$ sync`


## 2.4 环境变量管理  
使用**env**命令查询当前所有环境变量  
	`$ env`  

使用**export**命令修改环境变量,或者在原环境变量追加新内容  
	`$ export Test=test`
	`$ export PATH=newpath:$PATH`

使用**unset**命令删除环境变量  
	`$ unset Test`
 
环境变量的时效与应用范围基于使用命令的环境
	1. 临时修改+仅针对当前用户: 在当前shell中修改(立即生效)
	2. 永久修改+仅针对当前用户: 在~/.bash_profile文件中修改(系统重启生效或source文件) 
	3. 永久修改+对所有用户: 在/etc/profile文件中修改(系统重启生效)
	4. 永久修改+对所有用户: 在/etc/environment文件中修改(重启生效)

以在"~/.bash_profile添加PATH环境变量为例",按以下步骤进行:  
	1. 编辑器打开文件
 		`$ helix ~/.bash_profile`  
	2. 文件中添加环境变量
     		“export PATH=添加的路径:$PATH”  
	3. 文件生效,通过重启系统或通过**source**命令执行文件
		`$ source ~/.bash_profile`  


 
# 3 用户相关
linux系统中的用户类型分类:
	1. 超级用户root：属于组root  
	2. 管理员用户：属于管理员组wheel  
	3. 系统用户：针对某个服务的权限  
	4. 普通用户：不属于管理员组wheel的用户


## 3.1 用户信息查询
使用**id**命令查询用户的详细信息,包括UID,所属主组的GID,所属于附加组的GID和名称


## 3.2 用户切换
使用**su**命令切换不同的用户
	1. `$ su non_root_username`: 切换为非root用户但不切换目录
	2. `$ su `: 切换为root用户但不切换目录
	3. `$ su - non_root_username`: 切换为非root用户同时切换目录
	4. `$ su -`: 切换为root用户同时也切换目录 


## 3.3 用户修改
使用**useradd**命令新增用户
	`$ sudo useradd -m -G wheel username`
  		- "-m": 表示自动创建主目录
  		- "-G wheel": 表示附加组加入wheel组

使用**userdel**命令删除用户
	`$ sudo userdel -r username`
  		- "-r": 表示删除用户及其主目录(~/用户名称)和邮件池(/var/mail/用户名称)


## 3.4 用户信息修改
使用**usermod**命令修改用户信息
	- 修改用户组
  		`$ sudo usermod -aG groupname username`
    			- "-g": 修改用户的主组
    			- "-G": 修改用户的附加组
    			- "-aG": 追加用户的附加组,不修改原有附加组
	- 修改用户主目录
  		`$ sudo usermod -dm new_dirctoryname username`
    			- "-d": 修改用户的主目录
    			- "-m": 将原主目录内容迁移到新目录,需要与"-d"连用
	- 更改用户UID
  		`$ sudo usermod -u new_UID username`
  			- 用户状态控制
			- "-U":	解锁用户
  		`$ sudo usermod -L username`
    			- "-L": 锁定用户(禁止登录)
      		`$ sudo usermod -e 2024-12-31 username`
    			- "-e": 设置账户过期时间(YYYY-MM-DD)


## 3.5 用户组
用户组将多个用户组织起来,同一个组内的用户有相同的权限设置.
用户组分为主组与附加组,每个用户只能属于一个主组,但可以属于多个附加组.
用户加入组后将自动继承组的权限.

通过使用**getent**命令查询group的数据库,获取group信息
	- 查询所有组
  		`$ getent group`
	- 查询某个组的所有用户
  		`$ getent group groupname`

使用**groupadd**命令创建新组
	`$ sudo groupadd groupname`

使用**groupdel**命令删除组
	`$ sudo groupdel groupname`

使用**groupmod**命令修改组的属性
	- 修改组的名称
  		`sudo groupmod -n old_groupname new_groupname`
	- 修改组的GID
  		`sudo groupmod -g new_GID groupname`

使用**gpasswd**命令从组中移除用户  
	`$ sudo gpasswd -d username groupname`


  
# 4 文件相关
## 4.1 文件信息查询
使用**pwd**命令查询当前目录  
	`$ pwd`
  
使用**stat**命令查询文件的元数据信息,包括文件的唯一inode编号,权限,时间戳,磁盘占用等
	`$ stat filename or directoryname`

> inode是文件系统的核心数据结构,用于存储文件的元数据(metadata),而不是文件的实际内容.
每个文件或目录都对应一个唯一的inode,系统通过inode来管理文件.

使用**du**命令查询文件和目录占用空间情况 
	`$ du -sh path/filename`
  		- "-h": 自动转换大小单位(KB/MB/GB)
  		- "-s": 仅显示总大小,不显示子目录

使用**ls**命令查询当前目录下所有文件的信息  
	`$ ls -la`
  		- "-l": 显示详细信息,包含权限,所有者,大小等
  		- "-a": 显示隐藏文件(.文件)

上述命令会显示文件的信息,不同列会显示不同的信息:
	1. 第一列显示文件类型与不同用户对此文件的权限
    		1. 第一个表示文件类型
      			- "d"表示目录
      			- "l"表示连接文件(软链接)
      			- "-"表示普通文件
      			- "c"表示设备文件(如终端)
      			- "b"表示块设备文件(如硬盘)
      			- "s"表示哦套接字文件
      			- "p"表示管道文件 
    		2. 第2-4个表示u对此文件的权限: "u"表示文件的所有者用户,即创建文件的用户  
    		3. 第4-6个表示g对此文件的权限: "g"表示文件所属组,默认为创建者的主组
    		4. 第7-10个表示o对此文件的权限: "o"表示系统其他用户,即除了前两者的所有用户
    		5. "dr-xrwx--x"以这个文件信息为例 
      			- “d”表示其为目录 
      			- “r-x”表示u有“读取和执行”权限  
      			- “rwx”表示g有“读取写入执行”权限  
      			- “--x”表示o有“执行”权限
	2. 第二列表示指向文件的硬连接数
	3. 第三列表示文件的所有者  
	4. 第四列表示文件的所属组
	5. 第五列表示文件的大小,通常显示4096(Byte),表示目录元数据所占用的块大小,并非实际大小  
	6. 第六,七,八列表示最后修改的日期
	9. 表示文件或目录的名称 


## 4.2 文件修改 
	- 使用**mkdir**命令创建目录(文件夹)  
  		`$ mkdir directoryname`  
	- 使用**touch**命令创建文件  
  		`$ touch filename`
	- 使用**cat**命令查看文件内容  
  		`$ cat filename`
	- 使用**mv**命令移动文件,可以在目标目录路径后加上文件新名称以重命名文件
  		`$ mv filename path`
	- 使用**mv**命令重命名文件,相当于移动到同目录并重命名文件
  		`$ mv old_filename new_filename`
	- 使用**cp**命令复制文件,可以在目标目录路径后加上文件新名称以重命名文件
  		`$ cp filename path`
	- 使用**rm**命令删除文件  
  		`$ rm -rv filename`
    			- "-r": 递归删除(用于删除目录及其内容)
    			- "-v": 显示操作详情
    			- "-f": 强制删除,忽略不存在的文件
    			- "/var/log/*.log": 删除日志文件
    			- "/tmp/*": 删除临时文件
	- 使用**tar**命令解压相应格式文件
  		`$ tar -xvf filename.tar path`
    			- "-xvf": 解压".tar"格式文件  
    			- "-xzvf": 解压.tar.gz或.tgz格式文件  
    			- "-xjvf": 解压.tar.bz2 格式文件    
    			- "-xJvf": 解压.tar.xz 格式文件
    			- "path": 解压到的目录路径
	- 使用**7z**软件解压其余压缩包格式文件到当前目录  
  		`7z e filename.zip`


## 4.3 文件信息修改
使用**chmod**命令修改文件权限
	`$ chmod -Rv usertype ope per filename`
  		- "-R": 递归修改目录及其子内容权限
  		- "-v": 显示权限变更详情
  		- "usertype": 用户类型,为"u","g","o"
  		- "ope": 操作符,为"+"(增加权限),"-"(去掉权限),"="(直接设定权限,覆盖原有权限)
  		- "per": 权限类型,"r","w","x"
  		- 以"chmod -R u-rwx filename"命令为例,递归更改用户"u"对与filename的权限为去掉读取,写入,执行权限

使用**chown**命令更改文件所有者或所属组
	`$ chown -Rv new_own_username/UID :new_own_groupname/GID filename`  
    		- "-R": 递归删除(用于删除目录及其内容)
    		- "-v": 显示操作详情
    		- "new_own_username/UID": 更改文件的所有者的用户名或UID
    		- ":new_own_groupname/GID": 更改文件的所属组的组名或GID


## 4.4 打开文件
不同格式文件通过不同软件打开,通过**xdg-utils**软件管理XDG MIME应用程序 
	- 使用**xdg-open**命令条用系统默认程序打开文件,文件夹或URL  
    		`$ xdg-open file.pdf/URL`  
	- 使用**xdg-mine default**命令设置默认的应用程序打开特定类型的文件  
    		`$ xdg-mime default firefox.desktop application/pdf`: 默认使用firefox软件打开pdf格式文件
	- 使用**xdg-mine query**命令查询打开特点类型文件的默认程序
    		`$ xdg-mime query default application/pdf`: 查询打开pdf格式文件的默认程序 
	- 使用**xdg-setting set**命令设置默认应用程序
    		`$ xdg-settings set default-web-browser firefox.desktop`: 将Firefox设置为默认浏览器
	- 使用**xdg-setting get**命令查询默认应用程序  
    		`$ xdg-settings get default-web-browser`: 查询默认浏览器是什么应用程序 



# 5 软件相关
## 5.1 下载安装软件  
	- 使用**pacman**命令从官方库下载并安装
  		`$ sudo pacman -S packagename`
	- 使用**yay**软件(aur助手)从用户社区库下载安装  
	- 使用**openssh**软件从git仓库进行克隆或下载安装  

> 启动其他官方库:`$ sudoedit /etc/pacman.conf` 去掉要启用库的前面注释 
> 使用**pacman-contrib**软件中的paccache定期自动清楚安装包缓存:`systemctl enable --now paccache.timer`  


## 5.2 更新软件
	- 使用**pacman**命令更新所有软件
  		`$ sudo pacman -Syu`
	- 使用**yay**软件(aur助手)从用户社区库更新  
	- 使用**openssh**软件从git仓库进行克隆或下载安装  


## 5.3 卸载软件  
	- 使用**pacman**命令卸载软件及其所有没有被其他已安装软件包使用的依赖关系
  		`$ sudo pacman -Rs`  
	- 直接删除软件的文件  


## 5.4 软件进程
可以使用**top**命令来查看软件的进程信息,并与**grep**文本处理命令结合使用来查询特定信息
	`top | grep helix`: 查询"vim"软件的进程信息

使用**kill**命令终止进程
	`kill 15 PID`
  		- "-15": 默认正常终止进程
  		- "-9": 强制终止进程
  		- "-19": 暂停进程
  		- "-18": 恢复进程


   
# 6 硬件管理
## 6.1 磁盘管理
使用**lsblk**命令以树状结构列出所有块设备和简易信息
	`$ lsblk -f`
  		- "-f": 显示文件系统类型和挂载点
  
使用**df**命令查询磁盘空间使用情况,显示文件系统的挂载点,总容量,已用空间,可用空间及使用百分比.
	`$ df -h`
  		- "-h": 自动转换大小单位(KB/MB/GB)
  		- "-i": 检查inode使用情况

使用**cfdisk**命令进行图形化磁盘分区
	`$ cfdisk /dev/diskname`

使用**mkfs**命令格式化分区
	`$ sudo mkfs.fat -F 32 -L lablename device`
  		- ".fat": 指定文件系统类型,如"ext4","fat","ntfs","btrfs"
  		- "-F 32": 进一步指定FAT版本为FAT32
  		- "-L": 设置分区卷标的名称

使用**mkswap**命令初始化交换空间或交换文件,它会在指定设备或文件上创建交换区签名,
使系统能够将其用作虚拟内存(Swap),在物理内存(RAM)不足时充当扩展内存,防止系统因内存耗尽而崩溃.
	`$ sudo mkswap -L lablename device`

使用**mount**命令挂载分区 
	`$ sudo mount -t ntfs-3g device mountpoint --mkdir`
  		- "-t ntfs-3g": 指定挂载的文件类型,此类型由**ntfs-3g**软件提供
  		- "--mkdir": 当挂载点不存在时创建挂载点

使用**swapon**命令启动交换空间
	`$ sudo swapon device`
  		- "-a": 作用于所有的device
  		- "--show`: 查看当前交换空间状态 
 
使用**umount**命令卸载分区
	`$ sudo umount mountpoint`
  		- "-l": 延迟卸载,允许完成后台写入后卸载
  		- "-a": 卸载所有记录中加载的设备
  		- "-R": 递归卸载挂载点及其子挂载

使用**swapoff**命令临时禁用交换空间
	`$ sudo swapoff device`
  		- "-a": 作用于所有的交换空间


## 6.2 内存管理
使用**free**命令实时监控当前整体内存和交换空间的信息
	`$ free -h`
  		- "-h": 自动转换大小单位(KB/MB/GB)


## 6.3 CPU管理
使用**lscpu**命令查看CPU处理器架构和详细信息,包括CPU的物理核心,逻辑核心,缓存,型号,支持指令集
	`$ lscpu`


## 6.4 其他硬件管理
使用**lspci**命令扫描并列出所有PCI/PCIe设备,包括显卡,网卡,存储控制器等硬件信息
	`$ lspci -v`

使用**lspusb**命令是扫描并列出所有USB设备的命令,包括USB控制器,外接硬盘,键盘,鼠标等.
	`$ lsusb -v`   



# 7 bash配置
通过bash配置文件(~/.bashrc)配置
	1. 设置软件管理相关别名
    		`alias install='sudo pacman -S'`
    		`alias uninstall='sudo pacman -Rs'`
    		`alias update='sudo pacman -Syu'`
	2. 设置显示电脑信息函数
		now() {
	        	printf "\033[0;34m%s\033[0m\n" "$(date +'%Y-%m-%d %H:%M:%S')"
		}
		bat() {
			printf "\033[0;34m%s\033[0m\n" "$(cat /sys/class/power_supply/BAT0/capacity)" 
		}
		sound() {
			printf "\033[0;34m%s\033[0m\n" "$(bluetoothctl devices Connected)"
			printf "\033[0;34m%s\033[0m\n" "$(wpctl get-volume @DEFAULT_AUDIO_SINK@ && pactl get-sink-mute @DEFAULT_SINK@)"
		}
		mem() {
			printf "\033[0;34m%s\033[0m\n" "$(free | awk 'NR==2 {printf "%.1f%\n", ($2-$7)/$2*100}')"
		}
